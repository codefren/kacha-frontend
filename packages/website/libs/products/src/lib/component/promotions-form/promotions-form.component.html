<div class="bg-white2 optimroute-promotion-form" *ngIf="promotion">
    <div class="container">
        <div class="row justify-content-center pt-5 align-items-center">
            <div class="return-left mr-3 point" routerLink="/products/promotions">
                <i class="fas fa-angle-left addVehicleIcon p-1"></i>
            </div>

            <p class="title m-0" *ngIf="!promotion.id">
                {{ 'PROMOTIONS.ADD_PROMOTION' | translate }}
            </p>

            <p *ngIf="promotion.id" class="title m-0">
                {{ 'PROMOTIONS.EDIT_PROMOTION' | translate }}
            </p>
        </div>


        <div class="row justify-content-center">
            <form [formGroup]="promotionForm" class="form-width-prod">

                <div class="form-row justify-content-center mb-0 mt-3">
                    <a class="link" (click)="showModalImgInfo()">{{ 'PRODUCTS.HOW_IMAGE' | translate }}</a>
                </div>

                <!-- IMG -->
                <div class="form-row justify-content-xl-center  justify-content-center mt-2">
                    <div class="col-xl-4 col-12" *ngFor="let card of [1, 2, 3]; let i = index">
                        <easyroute-image-view [image]="productImages[i]" [index]="i" (error)="imageError = $event" [promotion]="true" [state]="state" [delete]="true" (deleteImage)="deleteProductImage($event.id, $event.image)" (updateImage)="_handleReaderLoaded($event.image)"
                            (changeMain)="selectMainImage($event)"></easyroute-image-view>
                    </div>

                    <!-- <ng-container *ngFor="let card of [1, 2, 3]; let i = index">
                        <easyroute-image-view [image]="productImages[i]" [index]="i" (error)="imageError = $event" [state]="state" [delete]="true" (deleteImage)="deleteProductImage($event.id, $event.image)" (updateImage)="_handleReaderLoaded($event.image)" (changeMain)="selectMainImage($event)"></easyroute-image-view>
                    </ng-container> -->
                    <div class="col-12 text-center" *ngIf="imageError.length > 0">
                        <span class="text-danger">{{ imageError }}</span>
                    </div>
                </div>

                <!-- END IMG -->


                <!-- Image Settings -->

                <div class="row mt-2">
                    <div class="col-12 pt-3 pl-xl-2">
                        <div class="col-sm-12 subtitle-general pl-0 pt-3">
                            <label class="sytle-eschedule mb-0">
                             {{ 'PROMOTIONS.IMAGE_SETTINGS' | translate }}
                           </label>
                        </div>
                    </div>

                    <div class="col-12 text-left pl-xl-2">
                        <label for="" class="text-muted parrafo m-0 text-justify">
                            {{ 'PROMOTIONS.IF_ACTIVATED_THE_PROMOTION_WILL_BE_SHOWN_THE_DIFFERENT_IMAGES_THAT_ARE_ATTACHED' | translate }}
                          
                        </label>
                    </div>

                    <div class="col-12 col-md-5 pr-sm-4 pl-xl-2">

                        <div class="form-row">
                            <div class="switch w-100">
                                <label class="switch-width mb-0">
                                    <input type="checkbox" formControlName="useImageRandom"/>
                                    <span class="lever switch-col-primary m-2"></span>
                                    {{ 'PROMOTIONS.USE_IMAGENES_RANDOMLY' | translate }}
                               </label>
                            </div>
                        </div>
                    </div>

                </div>

                <!-- end Image Settings -->


                <!-- PROMOTION_DATA -->
                <div class="row mt-2">

                    <div class="col-12 pt-3 pl-xl-2">
                        <div class="col-sm-12 subtitle-general pl-0 pt-3">
                            <label class="sytle-eschedule mb-0">
                             {{ 'PROMOTIONS.PROMOTION_DATA' | translate }}
                           </label>
                        </div>
                    </div>



                    <!-- active -->

                    <div class="col-12 col-md-5 pr-sm-4 pl-xl-2 mt-3">


                        <div class="form-row">
                            <div class="switch w-100">
                                <label class="switch-width mb-0">
                                    <input type="checkbox" formControlName="isActive"  (click)="changeActive()"/>
                                    <span class="lever switch-col-primary m-2"></span>
                                    {{ 'GENERAL.ACTIVE' | translate }}
                               </label>
                            </div>
                        </div>
                    </div>

                    <!-- end active -->

                    <!-- show-app -->

                    <div class="col-12 col-md-5 offset-md-2 pl-sm-4 pl-xl-2 mt-3">

                        <div class="form-row">
                            <div class="switch w-100">
                                <label class="switch-width mb-0">
                            <input type="checkbox" formControlName="showInApp"/>
                            <span class="lever switch-col-primary m-2"></span>
                            {{ 'PROMOTIONS.SHOW_PROMOTION_IN_APP' | translate }}
                          
                        </label>
                            </div>

                        </div>
                    </div>

                    <!-- end show-app -->

                    <!-- name -->
                    <div class="col-12 col-md-5 pr-sm-4">
                        <div class="form-row form-group" [ngClass]="{
                            'has-danger':
                                promotionForm.controls['name'].invalid &&
                                (promotionForm.controls['name'].dirty ||
                                    promotionForm.controls['name'].touched)
                        }">
                            <label for="promotion_name">
                            {{ 'PROMOTIONS.FORM.NAME' | translate }}
                            <span class="asterisco">*</span>
                        </label>

                            <input type="text" placeholder="{{ 'PROMOTIONS.FORM.NAME' | translate }}" id="promotion_name" class="form-control" autocomplete="off" formControlName="name" />

                            <ng-container *ngFor="let validation of promotion_messages.name">
                                <div class="w-100 text-left">
                                    <small class="form-control-feedback text-danger" *ngIf="
                                        promotionForm
                                            .get('name')
                                            .hasError(validation.type) &&
                                        (promotionForm.get('name').dirty ||
                                            promotionForm.get('name').touched)
                                    ">
                                    {{ validation.message }}
                                </small>
                                </div>
                            </ng-container>
                        </div>
                    </div>
                    <!-- end name -->

                    <!-- code -->
                    <div class="col-12 col-md-5 offset-md-2 pl-sm-4">
                        <div class="form-row form-group" [ngClass]="{ 'has-danger': promotionForm.controls['code'].invalid && (promotionForm.controls['code'].dirty || promotionForm.controls['code'].touched) }">
                            <ng-container *ngIf="showCode">

                                <label class="color-label-async" for="code">
                                    {{ 'VEHICLES.SERVICE_TYPE.CODE' | translate }}
                                </label>
                                <div class="input-group" [ngClass]="{ 'has-danger': promotionForm.controls['code'].invalid && ( promotionForm.controls['code'].dirty || promotionForm.controls['code'].touched)}">
                                    <input *ngIf="promotion.id > 0" type="text" readonly class="form-control code-edit-form" id="code" formControlName="code" placeholder="{{ 'PRODUCTS_GENERAL.PRODUCT_FORM.CODE' | translate }}" [ngClass]="{
                                        'form-control-danger':
                                        promotionForm.controls['code'].invalid &&
                                            (promotionForm.controls['code'].dirty ||
                                            promotionForm.controls['code'].touched)
                                    }" />
                                    <input *ngIf="!promotion.id" type="text" class="form-control" onKeyPress="if(this.value.length==31) return false;" id="code" formControlName="code" placeholder="{{ 'VEHICLES.SERVICE_TYPE.CODE' | translate }}" [ngClass]="{
                                        'form-control-danger':
                                        promotionForm.controls['code'].invalid &&
                                        (promotionForm.controls['code'].dirty ||
                                        promotionForm.controls['code'].touched)
                                    }" required/>
                                    <div class="input-group-append" *ngIf="!promotion.id">
                                        <a class="colorLink input-group-text point color-a-sync" (click)="searchPromotionCode()" id="tooltip" disabled="false" data-toggle="tooltip" data-placement="top" title="¿Buscar codigo?">
                                            <i class="fas fa-sync color-icon-sync"></i>
                                        </a>
                                    </div>

                                </div>

                                <label class="mt-0 color-label-info" *ngIf="!promotion.code">
                                        <i class="fas fa-sync"></i>
                                        {{ 'VEHICLES.SERVICE_TYPE.GEMERATE_CODE_AUTOMATICALLY' | translate }}
                                </label>
                                <ng-container *ngFor="let validation of promotion_messages.code">
                                    <div>
                                        <small class="form-control-feedback text-danger ml-2" *ngIf="
                                        promotionForm.get('code')
                                            .hasError(validation.type) &&
                                            (promotionForm.get('code').dirty ||
                                            promotionForm.get('code').touched)">
                                                {{ validation.message }}
                                            </small>
                                    </div>

                                </ng-container>


                            </ng-container>

                            <ng-container *ngIf="!showCode">
                                <div class="col-12 d-flex justify-content-center align-items-center">
                                    <div class="fa-3x mt-5">
                                        <i class="fas fa-circle-notch fa-spin"></i>
                                    </div>
                                </div>
                            </ng-container>
                        </div>
                        <!--  <div class="form-row form-group" [ngClass]="{
                            'has-danger':
                                promotionForm.controls['code'].invalid &&
                                (promotionForm.controls['code'].dirty ||
                                    promotionForm.controls['code'].touched)
                        }">
                            <label for="promotion_code">
                            {{ 'PROMOTIONS.FORM.CODE' | translate }}

                        </label>

                            <input type="text" placeholder="{{ 'PROMOTIONS.FORM.CODE' | translate }}" id="promotion_code" class="form-control" autocomplete="off" formControlName="code" />

                            <ng-container *ngFor="let validation of promotion_messages.code">
                                <div class="w-100 text-left">
                                    <small class="form-control-feedback text-danger" *ngIf="
                                        promotionForm
                                            .get('code')
                                            .hasError(validation.type) &&
                                        (promotionForm.get('code').dirty ||
                                            promotionForm.get('code').touched)
                                    ">
                                    {{ validation.message }}
                                </small>
                                </div>
                            </ng-container>
                        </div> -->
                    </div>
                    <!--end code -->



                    <!-- description -->
                    <div class="col-12 col-md-5 pr-sm-4">
                        <div class="form-row form-group" [ngClass]="{
                            'has-danger':
                                promotionForm.controls['description'].invalid &&
                                (promotionForm.controls['description'].dirty ||
                                    promotionForm.controls['description'].touched)
                        }">
                            <label for="promotion_description">
                            {{ 'PROMOTIONS.FORM.DESCRIPTION' | translate }}
                        </label>

                            <textarea class="form-control" placeholder="{{
                                'PROMOTIONS.FORM.DESCRIPTION' | translate
                            }}" autocomplete="off" formControlName="description" id="promotion_description"></textarea>

                            <ng-container *ngFor="let validation of promotion_messages.description">
                                <div class="w-100 text-left">
                                    <small class="form-control-feedback text-danger" *ngIf="
                                        promotionForm
                                            .get('description')
                                            .hasError(validation.type) &&
                                        (promotionForm.get('description').dirty ||
                                            promotionForm.get('description').touched)
                                    ">
                                    {{ validation.message }}
                                </small>
                                </div>
                            </ng-container>
                        </div>
                    </div>
                    <!-- end description -->

                    <!-- estimatedWeightPerUnit -->
                    <div class="col-12 col-md-5 offset-md-2 pl-sm-4">
                        <div class="form-row form-group">
                            <label for="estimatedWeightPerUnit">{{ 'PRODUCTS_GENERAL.PRODUCT_FORM.ESTIMATEDWEIGHTPERUNIT' | translate }}
                            </label>

                            <input type="number" step="0.001" id="estimatedWeightPerUnit" class="form-control" min="0" max="999" placeholder="{{ 'PRODUCTS_GENERAL.PRODUCT_FORM.ESTIMATEDWEIGHTPERUNIT' | translate }}" autocomplete="off" formControlName="estimatedWeightPerUnit" onKeyPress="if(this.value.length==7) return false;"
                            />
                            <ng-container *ngFor="let validation of promotion_messages.estimatedWeightPerUnit">
                                <div class="w-100 text-left">
                                    <small class="form-control-feedback text-danger" *ngIf="
                                        promotionForm.get('estimatedWeightPerUnit').hasError(
                                                validation.type
                                            ) &&
                                            (promotionForm.get('estimatedWeightPerUnit').dirty ||
                                            promotionForm.get('estimatedWeightPerUnit').touched)
                                        ">
                                        {{ validation.message }}
                                    </small>
                                </div>
                            </ng-container>
                        </div>
                    </div>
                    <!-- end estimatedWeightPerUnit -->

                    <!-- origin -->
                    <div class="col-12 col-md-5 pr-sm-4">
                        <div class="form-row form-group">
                            <label for="product_origin">
                                {{ 'PRODUCTS_GENERAL.PRODUCT_FORM.ORIGIN' | translate }}
                            </label>
                            <input type="text" placeholder="{{
                                    'PRODUCTS_GENERAL.PRODUCT_FORM.ORIGIN' | translate
                                }}" id="product_origin" class="form-control" autocomplete="off" formControlName="origin" />
                        </div>
                    </div>
                    <!--end origin -->

                    <!-- free field -->
                    <div class="col-12 col-md-5 offset-md-2 pl-sm-4">
                        <div class="form-row form-group" [ngClass]="{
                            'has-danger':
                                promotionForm.controls['freeField'].invalid &&
                                (promotionForm.controls['freeField'].dirty ||
                                    promotionForm.controls['freeField'].touched)
                        }">
                            <label for="freeField">{{ 'PRODUCTS.FREE_FIELD' | translate }}</label>
                            <input id="freeField" placeholder="{{ 'PRODUCTS.FREE_FIELD' | translate }}" type="text" formControlName="freeField" class="form-control">
                            <ng-container *ngFor="let validation of promotion_messages.freeField">
                                <div class="w-100 text-left">
                                    <small class="form-control-feedback text-danger" *ngIf="
                                    promotionForm.get('freeField').hasError(
                                        validation.type
                                    ) &&
                                    (promotionForm.get('freeField').dirty ||
                                        promotionForm.get('freeField').touched)
                            
                                    ">
                                    {{ validation.message }}
                                </small>
                                </div>
                            </ng-container>
                        </div>
                    </div>
                    <!-- end free field -->

                </div>
                <!-- end PROMOTION_DATA -->


                <!-- PROMOTION_DURATION -->
                <div class="row">
                    <div class="col-12 pt-3 pl-xl-2">
                        <div class="col-sm-12 subtitle-general pl-0 pt-3">
                            <label class="sytle-eschedule mb-0">
                             {{ 'PROMOTIONS.PROMOTION_DURATION' | translate }}
                           </label>
                        </div>
                    </div>

                    <div class="col-12 text-left pl-xl-2">
                        <label for="" class="text-muted parrafo m-0 text-justify">
                            {{ 'PROMOTIONS.DETERMINE_IF_YOU_WANT_TO_APPLY_A_DURATION_TIME_TO_IT_USING_THE_DATE' | translate }} 
                          
                        </label>
                    </div>

                    <div class="col-12 col-md-5 pr-sm-4 pl-xl-2">

                        <div class="form-row">
                            <div class="switch w-100">
                                <label class="switch-width mb-0">
                                    <input type="checkbox" formControlName="promotion"  (change)="changePromotion($event.target.checked)"/>
                                    
                                    <span class="lever switch-col-primary m-2"></span>
                                    {{ 'PROMOTIONS.APPLY_DURATION_TIME' | translate }}
                               </label>
                            </div>
                        </div>
                    </div>

                    <div class="col-12 col-md-5 offset-md-2 pl-sm-4 pl-xl-2">

                        <div class="form-row">
                            <div class="switch w-100">
                                <label class="switch-width mb-0">
                                    <input type="checkbox" formControlName="showPromotionCountDown"/>
                                    <span class="lever switch-col-primary m-2"></span>
                                    <button class="btn btn-cancel size-btn-form btn-eye p-0" type="button" (click)="openModal('showPromotionCountDown')">
                                        <i class="fas fa-eye point fas-eye"></i>
                                    </button>
                                    {{ 'PROMOTIONS.SHOW_PROMOTION_COUNTDOWN' | translate }}
                               </label>
                            </div>
                        </div>
                    </div>

                    <!-- promotion -->
                    <div class="col-12 col-md-5 pr-sm-4 pl-xl-2" *ngIf="promotionForm.get('promotion').value">
                        <div class="form-row">

                            <div class="form-row" *ngIf="promotionForm.get('promotion').value">
                                <div class="col-md-6 col-12 pr-sm-2 mb-1">
                                    <label class="control-label col-especial m-0" for="orderDate">
                                        {{ 'GENERAL.FROM' | translate  }}
                                    </label>
                                    <div class="input-group">
                                        <input class="form-control" placeholder="{{ 'GENERAL.FROM' | translate }}" autocomplete="off" id="startPromotionDate" formControlName="startPromotionDate" ngbDatepicker #d="ngbDatepicker" readonly id="startDemoDate" [startDate]="dateNow" />
                                        <div class="input-group-append">
                                            <button class="btn btn-calendar calendar" (click)="d.toggle()" type="button">
                                                <img
                                                    class="icons-calendar point"
                                                    src="assets/icons/optimmanage/calendar-outlines.svg"
                                                    aria-hidden="true"
                                                />
                                            </button>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6 col-12 pl-sm-2 mb-1">
                                    <label class="control-label col-especial m-0" for="orderDate">
                                        {{ 'GENERAL.TO' | translate }}
                                    </label>
                                    <div class="input-group">
                                        <input class="form-control" placeholder="{{ 'GENERAL.TO' | translate }}" autocomplete="off" id="endPromotionDate" formControlName="endPromotionDate" ngbDatepicker #b="ngbDatepicker" readonly id="startDemoDate" [startDate]="dateNow" />
                                        <div class="input-group-append">
                                            <button class="btn btn-calendar calendar" (click)="b.toggle()" type="button">
                                                <img
                                                    class="icons-calendar point"
                                                    src="assets/icons/optimmanage/calendar-outlines.svg"
                                                    aria-hidden="true"
                                                />
                                            </button>
                                        </div>
                                    </div>

                                    <ng-container *ngFor="
                                            let validation of promotion_messages.endPromotionDate
                                        ">
                                        <div class="w-100 text-left">
                                            <small class="form-control-feedback text-danger" *ngIf="
                                                    promotionForm
                                                        .get('endPromotionDate')
                                                        .hasError(validation.type) &&
                                                    (promotionForm.get('endPromotionDate')
                                                        .dirty ||
                                                        promotionForm.get(
                                                            'endPromotionDate'
                                                        ).touched)
                                                ">
                                                {{ validation.message }}
                                            </small>
                                        </div>
                                    </ng-container>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- end promotion -->


                </div>

                <!-- HIGHLIGHT_PRODUCT -->

                <div class="row">
                    <div class="col-12 pt-3 pl-xl-2">
                        <div class="col-sm-12 subtitle-general pl-0 pt-3">
                            <label class="sytle-eschedule mb-0">
                             {{ 'PROMOTIONS.HIGHLIGHT_PRODUCT' | translate }}
                           </label>
                        </div>
                    </div>

                    <div class="col-12 col-md-5 pr-sm-4">
                        <!-- destaced -->
                        <div class="form-row">
                            <div class="switch w-100 col-12">
                                <label class="switch-width">
                                    {{ 'PRODUCTS.FEATURED' | translate }}
                                    <input
                                        type="checkbox"
                                        (change)="changeHighlight($event.target.checked)"
                                        formControlName="highlight"
                                    />
                                    <span class="lever switch-col-primary"></span>
                                </label>
                            </div>


                        </div>


                    </div>
                    <div class="col-12 col-md-5 offset-md-2 pl-sm-4" *ngIf="promotionForm.get('highlight').value">
                        <label for="position_imp">{{ 'PRODUCTS.POSITION_BY_IMPORTANCE' | translate }}
                            <span class="asterisco">*</span>
                        </label>

                        <input type="number" id="position_imp" class="form-control" step="0.1" min="0" max="99999" placeholder="{{ 'PRODUCTS.VALORATION' | translate }}" autocomplete="off" formControlName="valoration" />
                        <ng-container *ngFor="let validation of promotion_messages.valoration">
                            <div class="w-100 text-left">
                                <small class="form-control-feedback text-danger" *ngIf="
                                        promotionForm
                                            .get('valoration')
                                            .hasError(validation.type) &&
                                        (promotionForm.get('valoration').dirty ||
                                            promotionForm.get('valoration').touched)
                                    ">
                                    {{ validation.message }}
                                </small>
                            </div>
                        </ng-container>
                        <!-- <div class="hack-input-time"></div> -->
                    </div>
                    <div class="col-12 col-md-5 pr-sm-4" *ngIf="
                    companyParentId &&
                    companyParentId != null &&
                    companyParentId > 0
                ">

                        <div class="form-row">
                            <label for="updatableFromCompanyParent">
                            {{ 'PRODUCTS.ALLOW_CHANGES_FROM_MAIN' | translate }}
                            <!-- <span data-toggle="tooltip" class="info" data-placement="top" title="{{ 'PRODUCTS.ALLOW_CHANGES_FROM_MAIN' | translate }}">
                                <i class="far fa-question-circle"></i>
                            </span> -->
                        </label>
                            <div class="round">
                                <input type="checkbox" id="updatableFromCompanyParent" formControlName="updatableFromCompanyParent" />
                                <label for="updatableFromCompanyParent"></label>
                            </div>
                        </div>

                    </div>
                </div>
                <!-- END HIGHLIGHT_PRODUCT -->


                <!-- END PROMOTION_DURATION -->

                <!-- Formato de promoción -->
                <div class="row">

                    <div class="col-12 pt-3 pl-xl-2">
                        <div class="col-sm-12 subtitle-general pl-0 pt-3">
                            <label class="sytle-eschedule mb-0">
                             {{ 'PROMOTIONS.PROMOTION_FORMAT' | translate }}
                           </label>
                        </div>
                    </div>

                    <div class="col-12 text-left pl-xl-2">
                        <label for="" class="text-muted parrafo m-0 text-justify">
                            {{ 'PROMOTIONS.DETERMINE_IF_YOU_WANT_THE_PROMOTION_TO_BE_INFORMATIONAL_ONLY' | translate }} {{'PROMOTIONS.JUST_VIEW_AN_IMAGE' | translate }} {{'PROMOTIONS.THAT_THE_USER_CAN_ACCESS_THE_PURCHASE_OF_THE_PROMOTION_LINK_TO_TYPE_OF_FORMAT' | translate }} {{'PROMOTIONS.WITH_THE_BUTTON_TO_ADD_AND_CHOOSE_FORMAT'| translate }} {{ 'PROMOTIONS.OR_A_CATEGORY_IS_LINKED' | translate }}
                          
                        </label>
                    </div>

                    <!-- tabla de medidas y precios -->
                    <div class="col-12 pl-xl-2">
                        <div class="card mt-3">
                            <div class="card-header">
                                <div class="w-100 d-flex flex-sm-row flex-column align-items-center justify-content-sm-between m-0 p-0">
                                    <div class="col-md-2 col-2  p-0">
                                        <select class="form-control" (change)="changeFilter($event.target.value)">
                                            <option value="active">Mostrar activos</option>
                                            <option value="inactive">Mostrar inactivos</option>
                                            <option value="all">Todas</option>
                                        </select>
                                    </div>
                                    <div class="col-md-2 col-5 p-0 offset-5 text-sm-right">
                                        <button class="btn btn-add card-button mt-2 mt-sm-0" type="button" title="{{ 'PRODUCTS_GENERAL.ADD_FORMAT' | translate }}" (click)="searchMeasure()">
                                        <label>{{ 'GENERAL.ADD' | translate }}</label>
                                    </button>
                                    </div>
                                </div>
                            </div>
                            <div class="card-body p-0">
                                <table class="table table-striped table-bordered table-responsive-lg mb-0" *ngIf="productsPrice.length > 0">
                                    <thead class="thead">
                                        <tr>
                                            <th class="text-center">Id</th>
                                            <th class="text-center">
                                                {{ 'GENERAL.NAME' | translate }}
                                            </th>
                                            <th class="text-center">
                                                {{ 'GENERAL.QUANTITY' | translate }}
                                            </th>
                                            <th class="text-center">
                                                {{ 'PRODUCTS_GENERAL.PRODUCT_FORM.PRICE' | translate }}
                                            </th>
                                            <th class="text-center">
                                                {{ 'PRODUCTS_GENERAL.PRODUCT_FORM.TAX' | translate }}
                                            </th>
                                            <th class="text-center">
                                                {{ 'PRODUCTS.EQUIVALENCE' | translate }}
                                            </th>
                                            <th class="text-center">
                                                {{ 'PRODUCTS_GENERAL.PRINCIPAL_IN_THE_APP' | translate }}
                                            </th>
                                            <th class="text-center" *ngIf="promotion.id > 0">
                                                {{ 'GENERAL.IS_ACTIVE' | translate }}
                                            </th>
                                            <th class="text-center">
                                                {{ 'GENERAL.ACTIONS' | translate }}
                                            </th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr *ngFor="let proprice of productsPrice; let i = index">
                                            <td data-title="Code" class="text-center">
                                                {{ proprice.measure?.id }}
                                            </td>
                                            <td data-title="Company" class="text-center">
                                                {{ proprice?.measure?.name }}
                                            </td>
                                            <td class="input-table" *ngIf="promotion.id == 0">
                                                <input class="input-table" type="number" min="0" (change)="
                                                    changePrice(
                                                        $event.target.value,
                                                        proprice,
                                                        etiquetaQantity
                                                    )
                                                " class="form-control" [value]="proprice?.quantity" />
                                            </td>
                                            <td class="input-table" *ngIf="promotion.id > 0">
                                                <input class="input-table" type="number" min="0" [disabled]="disablePrice" (change)="
                                                    updatePrice(
                                                        $event.target.value,
                                                        proprice,
                                                        etiquetaQantity
                                                    )
                                                " class="form-control" [value]="proprice?.quantity" />
                                            </td>

                                            <td class="input-table" *ngIf="promotion.id == 0">
                                                <input class="input-table" type="number" min="0" (change)="
                                                    changePrice(
                                                        $event.target.value,
                                                        proprice,
                                                        etiquetaPrice
                                                    )
                                                " class="form-control" [value]="proprice?.price" />
                                            </td>
                                            <td class="input-table" *ngIf="promotion.id > 0">
                                                <input class="input-table" type="number" min="0" [disabled]="disablePrice" (change)="
                                                    updatePrice(
                                                        $event.target.value,
                                                        proprice,
                                                        etiquetaPrice
                                                    )
                                                " class="form-control" [value]="proprice?.price" />
                                            </td>

                                            <td data-title="Company" class="text-center" *ngIf="promotion.id == 0">
                                                <input class="input-table" type="number" min="1" (change)="
                                                    changePrice(
                                                        $event.target.value,
                                                        proprice,
                                                        etiquetaTaxPercent
                                                    )
                                                " class="form-control" [value]="proprice?.taxPercent" />
                                            </td>
                                            <td data-title="Company" class="text-center" *ngIf="promotion.id > 0">
                                                <input class="input-table" type="number" min="1" [disabled]="disablePrice" (change)="
                                                    updatePrice(
                                                        $event.target.value,
                                                        proprice,
                                                        etiquetaTaxPercent
                                                    )
                                                " class="form-control" [value]="proprice?.taxPercent" />
                                            </td>

                                            <td data-title="Company" class="text-center" *ngIf="promotion.id == 0">
                                                <input class="input-table form-control" type="number" min="1" [value]="proprice?.equivalencePercent" (change)="
                                                    changePrice(
                                                        $event.target.value,
                                                        proprice,
                                                        etiquetaEquivalence
                                                    )
                                                " [value]="proprice?.equivalencePercent || 0" />
                                            </td>
                                            <td data-title="Company" class="text-center" *ngIf="promotion.id > 0">
                                                <input class="input-table" type="number" min="1" [disabled]="disablePrice" (change)="
                                                    updatePrice(
                                                        $event.target.value,
                                                        proprice,
                                                        etiquetaEquivalence
                                                    )
                                                " class="form-control" [value]="proprice?.equivalencePercent" />
                                            </td>
                                            <td *ngIf="promotion.id == 0" class="text-center">
                                                <div class="round" style="margin-left: 31px !important;">
                                                    <input type="radio" [id]="'mainProprice' + proprice.id" [checked]="proprice.main" (change)="activeMain(proprice,i)" />
                                                    <label [for]="'mainProprice' + proprice.id"></label>
                                                </div>
                                            </td>
                                            <td *ngIf="promotion.id > 0" class="text-center">
                                                <div class="round" style="margin-left: 31px !important;">
                                                    <input type="radio" [id]="'mainProprice' + proprice.id" [checked]="proprice.main" (change)="activeProductMain(proprice.main,proprice)" />
                                                    <label [for]="'mainProprice' + proprice.id"></label>
                                                </div>
                                            </td>
                                            <td *ngIf="promotion.id > 0" class="text-center">
                                                <!--  <div class="round">
                                                <input type="checkbox" id="isActiveProprice" [checked]="proprice.isActive"
                                                    (click)="activeProductPrice(proprice)" />
                                                <label for="isActiveProprice"></label>
                                            </div> -->
                                                <div class="round">
                                                    <input type="checkbox" [id]="'isActiveProprice' + proprice.id" [checked]="proprice.isActive" (click)="activeProductPrice(proprice)" />
                                                    <label [for]="'isActiveProprice' + proprice.id"></label>
                                                </div>
                                            </td>
                                            <td data-title="Open" class="text-center">
                                                <div *ngIf="promotion.id > 0" class="editar point" title="{{ 'GENERAL.DELETE' | translate }}" (click)="deleteProdutPrice(proprice.id)">
                                                    <img class="icons-datatable point" src="assets/icons/optimmanage/delete-blue.svg">
                                                    <!--   <img class="icons-datatable point" src="assets/icons/optimmanage/trash-bin.svg"> -->
                                                </div>
                                                <div *ngIf="promotion.id == 0" class="editar point" title="{{ 'GENERAL.DELETE' | translate }}" (click)="deleteproductPriceTable(proprice.id)">
                                                    <img class="icons-datatable point" src="assets/icons/optimmanage/delete-blue.svg">
                                                    <!-- <img class="icons-datatable point" src="assets/icons/optimmanage/trash-bin.svg"> -->
                                                </div>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>

                                <h5 class="text-center data-avalilable" *ngIf="productsPrice.length == 0">
                                    {{ 'GENERAL.NO_CUSTOMER_DATA_AVALILABLE' | translate }}
                                </h5>
                            </div>
                        </div>
                    </div>

                </div>
                <!-- END Formato de promoción -->


                <!-- cards all -->
                <div class="row">

                    <div class="col-12 pt-3 pl-xl-2">
                        <div class="col-sm-12 subtitle-general pl-0 pt-3">
                            <label class="sytle-eschedule mb-0">
                             {{ 'PROMOTIONS.LOCATION_AND_POSITION_OF_THE_PROMOTION_IN_THE_APP' | translate }}
                           </label>
                        </div>
                    </div>

                    <div class="col-12 text-left pl-xl-2">
                        <label for="" class="text-muted parrafo m-0 text-justify">
                            {{ 'PROMOTIONS.THE_PROMOTIONS_CAN_BE_LOCATED_DIFFERENT_SITES_CHOOSE_AND_ACTIVATE_THE_OPTION_IN_WHICH_YOU_WANT_THE_PROMOTION_TO_BE_DISPLAYED_IN_THE_APP' | translate }} 
                          <p class="text-muted  m-0 text-justify">{{'PROMOTIONS.CUSTOMIZE_IT_IN' | translate}} <a class="point link" (click)="openPromotionConfiguration()"> {{'PROMOTIONS.PROMOTION_CONFIGURATION' | translate }}. </a> </p> 
                        </label>
                    </div>


                    <!-- card showPromotionHome -->

                    <div class="col-12 pl-xl-2 mt-3">
                        <div class="card style-card-app mt-2">
                            <div class="card-body px-4">

                                <p class="card-title">
                                    {{ 'PROMOTIONS.SHOW_PROMOTION_ON_HOME' | translate }}
                                </p>

                                <p class="text-muted m-0 text-justify font-card"> {{ 'PROMOTIONS.THE_PROMOTION_ON_THE_HOME_PAGE_IS_AT_THE_TOP_OF_THE_APP_BY_SCROLLING_ALONG_WITH_THE_OTHER_PROMOTIONS' | translate }}</p>

                                <div class="col-12 col-md-12 pr-sm-4 pl-xl-2">

                                    <div class="form-row">
                                        <div class="switch w-100">
                                            <label class="switch-width mb-0">
                                               
                                                <input type="checkbox" formControlName="showPromotionHome"/>
                                                
                                                <span class="lever switch-col-primary m-2">
                                                    
                                                </span>
                                                <button class="btn btn-cancel size-btn-form btn-eye p-0" type="button" (click)="openModal('showPromotionHome')">
                                                    <i class="fas fa-eye point fas-eye"></i>
                                                </button>
                                                {{ 'PROMOTIONS.SHOW_PROMOTION_ON_HOME' | translate }}
                                                
                                           </label>
                                        </div>
                                    </div>
                                </div>

                            </div>

                        </div>
                    </div>

                    <!-- end showPromotionHome -->

                    <!-- card showPromotionTopCategoryList -->

                    <div class="col-12 pl-xl-2 mt-3">
                        <div class="card style-card-app mt-2">
                            <div class="card-body px-4">

                                <p class="card-title">
                                    {{ 'PROMOTIONS.SHOW_PROMOTION_AT_THE_TOP_THE_CATEGORY_LIST' | translate }}
                                </p>

                                <p class="text-muted m-0 text-justify font-card"> {{ 'PROMOTIONS.THE_PROMOTION_IN_THE_CATEGORY_LIST_WOULD_BE_DISPLAYED_AT_THE_TOP_OF_THE_SCREEN_AND_JUST_BELOW_ALL_CATEGORIES' | translate }}</p>

                                <div class="col-12 col-md-12 pr-sm-4 pl-xl-2">

                                    <div class="form-row">
                                        <div class="switch w-100">
                                            <label class="switch-width mb-0">
                                               
                                                <input type="checkbox" formControlName="showPromotionTopCategoryList"/>
                                                
                                                <span class="lever switch-col-primary m-2">
                                                    
                                                </span>
                                                <button class="btn btn-cancel size-btn-form btn-eye p-0" type="button" (click)="openModal('showPromotionTopCategoryList')">
                                                    <i class="fas fa-eye point fas-eye"></i>
                                                </button>
                                                {{ 'PROMOTIONS.SHOW_PROMOTION_AT_THE_TOP_THE_CATEGORY_LIST' | translate }}
                                                
                                           </label>
                                        </div>
                                    </div>
                                </div>

                            </div>

                        </div>
                    </div>

                    <!-- end showPromotionTopCategoryList -->

                    <!-- showPromotionBetweenProducts -->

                    <div class="col-12 pl-xl-2 mt-3">
                        <div class="card style-card-app mt-2">
                            <div class="card-body px-4">

                                <p class="card-title">
                                    {{ 'PROMOTIONS.SHOW_PROMOTION_BETWEEN_PRODUCTS' | translate }}
                                </p>

                                <p class="text-muted m-0 text-justify font-card"> {{ 'PROMOTIONS.THE_PROMOTION_BETWEEN_PRODUCTS_WILL_BE_DISPLAYED_EVERY_X_PRODUCTS_IF_YOU_STILL_DO_NO_HAVE_IT_CONFIGURED_GO_TO' | translate }} <a class="point link" (click)="openPromotionConfiguration()"> {{'PROMOTIONS.PROMOTION_CONFIGURATION' | translate }}. </a></p>

                                <div class="col-12 col-md-12 pr-sm-4 pl-xl-2">

                                    <div class="form-row">
                                        <div class="switch w-100">
                                            <label class="switch-width mb-0">
                                               
                                                <input type="checkbox" formControlName="showPromotionBetweenProducts"/>
                                                
                                                <span class="lever switch-col-primary m-2">
                                                    
                                                </span>
                                                <button class="btn btn-cancel size-btn-form btn-eye p-0" type="button" (click)="openModal('showPromotionBetweenProducts')">
                                                    <i class="fas fa-eye point fas-eye"></i>
                                                </button>
                                                {{ 'PROMOTIONS.SHOW_PROMOTION_BETWEEN_PRODUCTS' | translate }}
                                                
                                           </label>
                                        </div>
                                        <div class="col-12 col-md-12 pr-sm-4 pl-xl-4" *ngIf="promotionForm.get('showPromotionBetweenProducts').value">

                                            <div class="form-row">

                                                <div class="switch w-100">
                                                    <img class="img-arrow" src="assets/icons/optimmanage/Vector.svg">
                                                    <label class="switch-width mb-0">
                                                       
                                                        <input type="checkbox" formControlName="showSpecificCategory"/>
                                                        
                                                        <span class="lever switch-col-primary m-2">
                                                            
                                                        </span>
                                                       
                                                        {{ 'PROMOTIONS.ASSIGN_AND_SHOW_ONLY_IN_A_SPECIFIC_CATEGORY' | translate }}
                                                        
                                                   </label>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="form-row">
                                    <div class="col-md-5  offset-xl-1 pl-sm-4" *ngIf="promotionForm.get('showPromotionBetweenProducts').value && promotionForm.get('showSpecificCategory').value">
                                        <div class="form-group no-margin" [ngClass]="{
                                            'has-danger':
                                            promotionForm.controls['showPromotionCategoryId'].invalid &&
                                                (promotionForm.controls['showPromotionCategoryId'].dirty ||
                                                promotionForm.controls['showPromotionCategoryId'].touched)
                                        }">
                                            <label for="product_category">
                                            {{ 'PROMOTIONS.ASSIGN_CATEGORY' | translate }}
                                        </label>
                                            <ng-container *ngIf="loadingCompanyList == 'loading'">
                                                <div class="col-12 text-center p-2">
                                                    <div class="fa-2x">
                                                        <i class="fas fa-circle-notch fa-spin"></i>
                                                    </div>
                                                </div>
                                            </ng-container>
                                            <ng-container *ngIf="loadingCompanyList == 'error'">
                                                <div class="col-12">
                                                    <p class="text-danger pointer" (click)="getCategory()">
                                                        {{ 'GENERAL.THERE_WAS' | translate }}
                                                        <ins>{{ 'GENERAL.HERE' | translate }}</ins
                                                    >!
                                                </p>
                                            </div>
                                        </ng-container>
                                        <ng-container
                                            *ngIf="
                                            category && category.length == 0 && loadingCompanyList == 'success'
                                            "
                                        >
                                            <div class="col-12 text-center p-2">
                                                <p class="text-danger">
                                                    {{ 'PRODUCTS.NO_CATEGORY_REGISTERED' | translate }}
                                                </p>
                                            </div>
                                        </ng-container>
                
                                        <ng-container
                                            *ngIf="
                                            category && category.length > 0 && loadingCompanyList == 'success'
                                            "
                                        >
                                            <select
                                                id="product_category"
                                                class="form-control"
                                                formControlName="showPromotionCategoryId"
                                                (change)="loadSubCategory($event.target.value)"
                                            >
                                                <option value="">{{
                                                    'GENERAL.SELECT' | translate
                                                }}</option>
                                                <option
                                                    *ngFor="let categorylist of category"
                                                    [value]="categorylist.id"
                                                >
                                                    {{ categorylist.name }}
                                                </option>
                                            </select>
                                            <!-- <div class="hack-select"></div> -->
                
                                            <ng-container
                                                *ngFor="let validation of promotion_messages.categoryId"
                                            >
                                                <div class="w-100 text-left">
                                                    <small
                                                        class="form-control-feedback text-danger"
                                                        *ngIf="
                                                        promotionForm.get('showPromotionCategoryId').hasError(
                                                                validation.type
                                                            ) &&
                                                            (promotionForm.get('showPromotionCategoryId').dirty ||
                                                            promotionForm.get('showPromotionCategoryId').touched)
                                                        "
                                                    >
                                                        {{ validation.message }}
                                                    </small>
                                                </div>
                                            </ng-container>
                                        </ng-container>
                                        </div>
                                    </div>
                                    <div class="col-md-5 pl-sm-4" *ngIf="promotionForm.get('showPromotionBetweenProducts').value && promotionForm.get('showSpecificCategory').value && promotionForm.get('showPromotionCategoryId').value && subcategory && subcategory.length > 0">
                                        <div class="form-group no-margin" [ngClass]="{
                                            'has-danger':
                                            promotionForm.controls['showPromotionCategoryId'].invalid &&
                                                (promotionForm.controls['showPromotionCategoryId'].dirty ||
                                                promotionForm.controls['showPromotionCategoryId'].touched)
                                        }">
                                            <label for="product_category">
                                            {{ 'PROMOTIONS.ASSIGN_SUBCATEGORY' | translate }}
                                        </label>
                                            <ng-container *ngIf="loadingCompanyList == 'loading'">
                                                <div class="col-12 text-center p-2">
                                                    <div class="fa-2x">
                                                        <i class="fas fa-circle-notch fa-spin"></i>
                                                    </div>
                                                </div>
                                            </ng-container>
                                            <ng-container *ngIf="loadingCompanyList == 'error'">
                                                <div class="col-12">
                                                    <p class="text-danger pointer" (click)="getCategory()">
                                                        {{ 'GENERAL.THERE_WAS' | translate }}
                                                        <ins>{{ 'GENERAL.HERE' | translate }}</ins
                                                    >!
                                                </p>
                                            </div>
                                        </ng-container>
                                        <ng-container
                                            *ngIf="
                                            category && category.length == 0 && loadingCompanyList == 'success'
                                            "
                                        >
                                            <div class="col-12 text-center p-2">
                                                <p class="text-danger">
                                                    {{ 'PRODUCTS.NO_CATEGORY_REGISTERED' | translate }}
                                                </p>
                                            </div>
                                        </ng-container>
                
                                        <ng-container
                                            *ngIf="
                                            category && category.length > 0 && loadingCompanyList == 'success'
                                            "
                                        >
                                            <select
                                                id="product_category"
                                                class="form-control"
                                                formControlName="showPromotionSubCategoryId"
                                            >
                                                <option value="">{{
                                                    'GENERAL.SELECT' | translate
                                                }}</option>
                                                <option
                                                    *ngFor="let subcategorylist of subcategory"
                                                    [value]="subcategorylist.id"
                                                >
                                                    {{ subcategorylist.name }}
                                                </option>
                                            </select>
                                            <!-- <div class="hack-select"></div> -->
                
                                            <ng-container
                                                *ngFor="let validation of promotion_messages.subCategoryId"
                                            >
                                                <div class="w-100 text-left">
                                                    <small
                                                        class="form-control-feedback text-danger"
                                                        *ngIf="
                                                        promotionForm.get('showPromotionSubCategoryId').hasError(
                                                                validation.type
                                                            ) &&
                                                            (promotionForm.get('showPromotionSubCategoryId').dirty ||
                                                            promotionForm.get('showPromotionSubCategoryId').touched)
                                                        "
                                                    >
                                                        {{ validation.message }}
                                                    </small>
                                                </div>
                                            </ng-container>
                                        </ng-container>
                                        </div>
                                    </div>
                                </div>
                                
                              
                            </div>



                        </div>
                    </div>

                    <!-- end showPromotionBetweenProducts -->


                </div>
                <!-- end card all -->

                <div class="row pt-5 pb-3">
                    <div class="col-sm-6 col-12 text-center text-sm-right mt-1">
                        <button class="btn btn-cancel size-btn-form" type="button" routerLink="/products/promotions">
                            {{ 'GENERAL.CANCEL' | translate }}
                        </button>
                    </div>
                    <div class="col-sm-6 col-12 text-center text-sm-left mt-1 pb-2">
                        <button (click)="createProduct()" class="btn btn-primary size-btn-form" [disabled]="promotionForm.invalid || productsPrice.length === 0">
                            <span *ngIf="promotion.id == 0">{{
                                'GENERAL.ADD' | translate
                            }}</span>
                            <span *ngIf="promotion.id > 0">{{
                                'GENERAL.SAVE' | translate
                            }}</span>
                        </button>
                    </div>
                </div>
            </form>
        </div>
    </div>
</div>