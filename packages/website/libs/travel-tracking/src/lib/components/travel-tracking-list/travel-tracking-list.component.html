<div class="travel-tracking-list main-container container-fluid p-2 pt-4 pb-4">

    <!-- Header -->

    <div class="d-flex row align-items-center justify-content-between pl-4 pr-4">

        <div class="col-12 col-xxl col-lg-6 col-sm-6 d-flex flex-row align-items-center justify-content-start">

            <div class="page-title">

                <span> {{ 'TRAVEL_TRACKING.NAME' | translate }} </span>
            </div>

        </div>

        <div class="col-xl-6 col-12 text-right">

            <div class="d-flex form-row flex-row align-items-center justify-content-end">

                <ng-container>
                    <!-- settings -->

                    <button class="btn btn-icon btn-icon-white dropdown-toggle p-2 mt-xl-0 mt-2" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                        <img src="assets/icons/point.svg">
                    </button>

                    <div class="dropdown-menu letdrop" aria-labelledby="dropdownMenuButton">

                        <a class="dropdown-item drop-title border-drop pt-3 pb-3 point" (click)="ftpJsonRoute()" *ngIf="zones && zones.length > 0" [ngClass]="{'disabled': selected.length == 0}">

                            <img src="assets/icons/pdf1.svg" class="pr-2"> {{ 'TRAVEL_TRACKING.SEND_TO_SELECTED_FTP' | translate }}

                        </a>

                        <a class="dropdown-item drop-title border-drop pt-3 pb-3 point" (click)="ftpJsonRouteGeneral()" *ngIf="zones && zones.length > 0" [ngClass]="{'disabled': zones && zones.length == 0}">

                            <img src="assets/icons/pdf1.svg" class="pr-2"> {{ 'TRAVEL_TRACKING.SEND_TO_FPT_ALL' | translate }}

                        </a>

                        <a class="dropdown-item drop-title pt-3 pb-3 point" (click)="openSetting()">

                            <img src="assets/icons/setting.svg" class="pr-2"> {{ 'GENERAL.SETTING' | translate }}

                        </a>

                    </div>

                    <!-- settings -->

                    <!-- dash -->

                    <button class="btn btn-icon btn-icon-white img-dash btn-large ml-2 mt-xl-0 mt-2" title="Ir a Dashborad" (click)="openDash()" *ngIf="zones && zones.length > 0">

                        <img src="assets/icons/dash.svg" class="pr-2">

                        {{'TRAVEL_TRACKING.DASHBOARD' | translate }}

                    </button>

                    <!-- end dash -->


                    <!-- cargar albares -->



                    <div class="dropdown" *ngIf="zones && zones.length > 0">

                        <button class="btn btn-icon btn-icon-white size-load-albaran btn-large ml-2" type="button" id="dropdownMenuButton1" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" *ngIf="zones && zones.length > 0">

                            {{'TRAVEL_TRACKING.UPLOAD_DELIVERY_NOTE' | translate }}

                        </button>


                        <button class="btn btn-icon btn-icon-white size-open btn-large" type="button" *ngIf="zones && zones.length > 0" id="dropdownMenuButton1" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">

                            <img src="assets/icons/donw.svg">

                        </button>

                        <form>
                            <div class="form-group">
                                <input #fileImportProductGlobal hidden type="file" class="form-control-file" accept=".json" (change)="
                                    importProductGlobal(
                                        $event.target.files[0]
                                    );
                                    $event.target.value = null
                                " />
                            </div>
                        </form>

                        <div class="dropdown-menu notification-menu-1" aria-labelledby="dropdownMenuButton1" *ngIf="zones && zones.length > 0">

                            <!-- importar json -->

                            <a class="dropdown-item drop-title border-drop pt-3 pb-3 point" (click)="fileImportProductGlobal.click()">

                                <img src="assets/icons/import.svg" class="pr-2"> {{ 'TRAVEL_TRACKING.TO_IMPORT' | translate }}

                            </a>

                            <!-- end importar json -->

                            <!-- importar desde la nube -->

                            <a class="dropdown-item drop-title  pt-3 pb-3 point" [ngClass]="{'border-drop': (optimizationPreferences$ | async).activateDeliveryNoteIntegration}" (click)="ImportProductFromCloudGlobal()">

                                <img src="assets/icons/import.svg" class="pr-2"> {{ 'TRAVEL_TRACKING.IMPORT_FROM_CLOUD' | translate }}

                            </a>

                            <!-- end importar desde la nube -->

                            <!-- loadTemplate -->

                            <ng-container *ngIf="(optimizationPreferences$ | async).activateDeliveryNoteIntegration">
                                <a class="dropdown-item drop-title pt-3 pb-3 point" (click)="loadTemplateDeliveryPoint()">

                                    <img src="assets/icons/import.svg" class="pr-2"> {{ 'TRAVEL_TRACKING.IMPORT_FROM_TEMPLATE' | translate }}

                                </a>
                            </ng-container>




                        </div>

                    </div>

                    <!-- end cargar alaren -->





                    <!-- actiones -->

                    <div class="dropdown">
                        <button class="btn btn-secondary btn-large ml-2 btn-actios mt-xl-0 mt-2" type="button" id="dropdownMenuButton1" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" *ngIf="zones && zones.length > 0" title="{{ 'LOADING_DOCK.FORCE_FINISHED' | translate }}">

                            <img src="assets/icons/plus.svg" class="pr-2">

                            {{ 'TRAVEL_TRACKING.ACTIONS' | translate }}

                        </button>

                        <button class="btn btn-secondary  size-open btn-large mt-xl-0 mt-2" type="button" *ngIf="zones && zones.length > 0" id="dropdownMenuButton1" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">

                            <img src="assets/icons/donwWrite.svg">

                        </button>



                        <div class="dropdown-menu notification-menu-1" aria-labelledby="dropdownMenuButton1" *ngIf="zones && zones.length > 0">



                            <a class="dropdown-item drop-title border-drop  pt-3 pb-3 point" (click)="createRetainerRoute()">

                                <img src="assets/icons/addActios.svg" class="pr-2"> {{ 'TRAVEL_TRACKING.CREATE_TRIP_CATCH' | translate }}

                            </a>





                            <a class="dropdown-item drop-title pt-3 pb-3 point" (click)="createClient()" *ngIf="zones && zones.length > 0">

                                <img src="assets/icons/addActios.svg" class="pr-2"> {{ 'TRAVEL_TRACKING.ADD_CLIENT' | translate }}

                            </a>



                        </div>

                    </div>

                    <!-- end actiones -->


                </ng-container>



            </div>

        </div>

    </div>



    <!-- Cuadros informativos -->

    <div class="row align-items-center mt-3 pl-4 pr-4">

        <div class="col-xl col-md-6 col-12">

            <div class="card card-left p-3">

                <p class="p-title"> {{ 'TRAVEL_TRACKING.FINISHED_ROUTES' | translate }} </p>

                <ng-container *ngIf="showCode">
                    <p class="p-sub-number" *ngIf="totalizedDate"> {{ totalizedDate.totalFinishedRoute }}/{{ totalizedDate.totalRoute }} </p>
                </ng-container>

                <ng-container *ngIf="!showCode">
                    <div class="fa-2x">
                        <i class="fas fa-circle-notch fa-spin"></i>
                    </div>
                </ng-container>

            </div>
        </div>

        <div class="col-xl col-md-6 col-12 mt-xl-0 mt-2">

            <div class="card card-left p-3">

                <p class="p-title"> {{'TRAVEL_TRACKING.RETURNS' | translate }} </p>

                <ng-container *ngIf="showCode">
                    <p class="p-sub-number" *ngIf="totalizedDate"> {{ totalizedDate.totalDevolution }} </p>
                </ng-container>

                <ng-container *ngIf="!showCode">
                    <div class="fa-2x">
                        <i class="fas fa-circle-notch fa-spin"></i>
                    </div>
                </ng-container>

            </div>

        </div>

        <div class="col-xl col-md-6 col-12 mt-xl-0 mt-2">

            <div class="card card-left p-3">

                <p class="p-title"> {{'TRAVEL_TRACKING.INCIDENTS' | translate }} </p>

                <ng-container *ngIf="showCode">
                    <p class="p-sub-number" *ngIf="totalizedDate"> {{ totalizedDate.totalIncident }} </p>
                </ng-container>

                <ng-container *ngIf="!showCode">
                    <div class="fa-2x">
                        <i class="fas fa-circle-notch fa-spin"></i>
                    </div>
                </ng-container>

            </div>

        </div>

        <div class="col-xl col-md-6 col-12 mt-xl-0 mt-2">

            <div class="card card-left p-3">

                <p class="p-title"> {{'TRAVEL_TRACKING.MODIFICATIONS' | translate }} </p>

                <ng-container *ngIf="showCode">
                    <p class="p-sub-number" *ngIf="totalizedDate"> {{ totalizedDate.totalModification }} </p>
                </ng-container>

                <ng-container *ngIf="!showCode">
                    <div class="fa-2x">
                        <i class="fas fa-circle-notch fa-spin"></i>
                    </div>
                </ng-container>

            </div>

        </div>

        <div class="col-xl col-md-6 col-12 mt-xl-0 mt-2">

            <div class="card card-left p-3">

                <p class="p-title"> {{'TRAVEL_TRACKING.BALANCE_BOXES' | translate }} </p>

                <ng-container *ngIf="showCode">
                    <p class="p-sub-number" *ngIf="totalizedDate"> {{ totalizedDate.TotalDeliveredBoxes }} </p>
                </ng-container>

                <ng-container *ngIf="!showCode">
                    <div class="fa-2x">
                        <i class="fas fa-circle-notch fa-spin"></i>
                    </div>
                </ng-container>

            </div>

        </div>

        <div class="col-xl col-md-6 col-12 mt-xl-0 mt-2">

            <div class="card card-left p-3">

                <div class="page-title-span point">


                    <ng-container *ngIf="totalRefueling && totalRefueling.total_import > 0">
                        <img class="float-load point" src="assets/icons/travelIcons/addLoad2.svg" style="vertical-align: top; height: 19px" (click)="openModalRepostaje()">
                    </ng-container>

                    <!--    <span class="ml-2 point spand-title-card"> Repostaje </span> -->

                    <span class="p-title"> {{'TRAVEL_TRACKING.TOTAL_REFUELING' | translate }} </span>



                </div>





                <ng-container *ngIf="showCode">
                    <p class="p-sub-number mt-3" *ngIf="totalRefueling"> {{ decimal(totalRefueling.total_import) }} </p>
                </ng-container>

                <ng-container *ngIf="!showCode">
                    <div class="fa-2x">
                        <i class="fas fa-circle-notch fa-spin"></i>
                    </div>
                </ng-container>

            </div>

        </div>

    </div>


    <!-- filter -->
    <div class="row mt-3 pl-4 pr-4 align-items-center font-row mb-xl-0 mb-2">

        <div class="col-xl-9 col-12">

            <div class="form-row mb-1 mt-2 pl-1 align-items-center">

                <!-- date -->

                <div class="col-12 col-xl-2 col-sm-4 mb-1">

                    <div class="input-group">

                        <input ngbDatepicker #f="ngbDatepicker" type="text" class="form-control form-control-date size-date" autocomplete="off" [min]="min" [formControl]="dateSearchFrom" (dateSelect)="changeDate('from', $event)" placeholder="Seleccione ..." id="dateDeliveryStart"
                        />

                        <button class="btn btn-calendar calendar" (click)="f.toggle()" type="button">

                            <img class="icons-calendar point" src="assets/icons/Vector.svg" aria-hidden="true">
                        </button>

                    </div>

                    <!-- <pre>From date model: {{ fromDate | json }}</pre>
                    <pre>To date model: {{ toDate | json }}</pre>  -->
                </div>

                <!-- end date -->

                <!-- all route -->

                <div class="col-12 col-xl-2 col-sm-4 mb-1 point">

                    <ng-container *ngIf="showZones">

                        <select id="routePlanningRouteId" [value]="filter.values.routePlanningRouteId" (change)="changeroutePlanningRouteId($event)" class="form-control-select-datatable size-select form-control form-control-select  select-search-user point">

                            <option value=""> {{ 'TRAVEL_TRACKING.ALL_ROUTES' | translate }} </option>

                            <option *ngFor="let item of zones" [value]="item.id"> {{ item.name }} </option>

                        </select>

                    </ng-container>

                    <ng-container *ngIf="!showZones">

                        <div class="col-12 text-center mt-2">

                            <div class="fa-4x">

                                <i class="fas fa-circle-notch fa-spin"></i>

                            </div>

                        </div>

                    </ng-container>

                </div>

                <!-- end all route -->

                <!-- users -->

                <div class="col-12 col-xl-2 col-sm-4 mb-1 point">

                    <ng-container *ngIf="showUser">

                        <select id="userId" [value]="filter.values.userId" (change)="changeUserId($event)" class="form-control-select-datatable size-select form-control form-control-select  select-search-user point">

                            <option value=""> {{ 'COST.USERS' | translate }} </option>

                            <option *ngFor="let item of users" [value]="item.id"> {{ item.name }} {{ item.surname }}
                            </option>

                        </select>

                    </ng-container>



                    <ng-container *ngIf="!showUser">

                        <div class="col-12 text-center mt-2">

                            <div class="fa-4x">

                                <i class="fas fa-circle-notch fa-spin"></i>

                            </div>

                        </div>

                    </ng-container>
                </div>

                <!-- end users -->

            </div>

        </div>

        <div class="col-xl-3 col-12">

            <div class="row">

                <div class="col-xl-9 col-12">

                    <div class="input-group datatables-input-group-width mr-xl-3 mr-3">

                        <input id="search" type="text" class="form-control search-general
                                pull-right input-personalize-datatable" [(ngModel)]="inputFilter" (keyup)="searchValue($event.target.value)" placeholder="{{ 'COST.SEARCH' | translate }}" style="max-width: initial;">

                        <span class="input-group-append input-group-appenda">

                            <span class="input-group-text input-group-text-general table-append">

                                <img class="icons-search" src="assets/icons/optimmanage2/icono-lupanaranja.svg">

                            </span>

                        </span>

                        <div id="list-example" class="list-group result-search mt-2" *ngIf="deliveryPointFilter && deliveryPointFilter.length > 0">
                            <a class="list-group-item list-group-item-action pointer" (click)="selectDeliveryPoint(point)" *ngFor="let point of deliveryPointFilter">
                                {{ point.name }}
                            </a>
                        </div>

                    </div>

                </div>

                <div class="col-xl-3 col-12 text-center mt-xl-0 mt-2">

                    <button class="btn btn-default btn-edit-travel" id="dt-buttons-table" type="button">

                        <img src="assets/icons/edittable.svg">

                        Tabla

                    </button>

                </div>

            </div>


        </div>


    </div>

    <!-- end filter -->



    <!-- table -->

    <div class="row">
        <div class="col-12">
            <div class="table-content table-content-general">

                <table class="table table-striped table-bordered table-responsive-lg mb-0" id="travelTracking" style="text-align: center; width: 100%;">

                    <thead>

                        <tr>
                            <th>

                                <div class="row justify-content-center align-items-center p-0" style="background-color: transparent;">
                                    <div class="round-style-cost  round-little-cost">
                                        <input type="checkbox" checked="" id="checkboxDriverCost" [(ngModel)]="selectAll" (change)="selectAllFunc()">
                                        <label for="checkboxDriverCost" class="m-0"></label>
                                    </div>
                                </div>
                            </th>

                            <th class=" padding-travel" style="width: 19%"> {{ 'TRAVEL_TRACKING.ROUTE' |translate }}
                            </th>

                            <th class="" style="width: 10%"> {{ 'TRAVEL_TRACKING.PROCESS' |translate }} </th>

                            <th class="" style="width: 25%"> {{ 'TRAVEL_TRACKING.CONDITION' |translate }} </th>

                            <th class=""> {{ 'TRAVEL_TRACKING.ASSIGNED_DRIVER' | translate }} </th>

                            <th class=""> {{ 'TRAVEL_TRACKING.VEHICLE_REGISTRATION' | translate }} </th>

                            <th class=""> {{ 'TRAVEL_TRACKING.INIT' | translate }} </th>

                            <th class=""> {{ 'TRAVEL_TRACKING.END' | translate }} </th>

                            <th class=""> {{ 'TRAVEL_TRACKING.CLIENT' | translate }} </th>

                            <th class=""> {{ 'TRAVEL_TRACKING.ALBARANS' | translate }} </th>

                            <th class="" width="2%"> {{ 'TRAVEL_TRACKING.BILLING' | translate }} </th>

                            <th class=""> {{ 'TRAVEL_TRACKING.DELAY_TIME' | translate }} </th>

                            <th class="" width="2%">Fuera radio</th>

                            <th class="" width="2%"> {{ 'TRAVEL_TRACKING.INCIDENTS' | translate }} </th>

                            <th class="" width="2%"> {{ 'TRAVEL_TRACKING.RETURNS' | translate }} </th>

                            <th class="">{{ 'TRAVEL_TRACKING.COST' | translate }}</th>

                        </tr>

                    </thead>

                    <tbody></tbody>
                </table>
            </div>
        </div>
    </div>

</div>